<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>HSK 4ê¸‰ ì‘ë¬¸ í€´ì¦ˆ</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      padding: 2rem;
      display: flex;
      gap: 2rem;
    }
    .main {
      flex: 2;
    }
    .note {
      flex: 1;
      background: #fff;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 0 5px #ccc;
      height: fit-content;
    }
    h2 {
      margin-bottom: 1rem;
    }
    #question {
      background: #fff;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: 0 0 5px #ccc;
    }
    input[type="text"] {
      width: 100%;
      font-size: 1.1rem;
      padding: 0.6rem;
      margin-top: 0.5rem;
    }
    button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
    }
    #feedback {
      margin-top: 1rem;
      font-weight: bold;
    }
    .result-box {
      background: #eef;
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
    }
    .result-line {
      margin-bottom: 0.5rem;
    }
    .wrong {
      color: red;
      font-weight: bold;
    }
    .explain {
      margin-top: 1rem;
      background: #fff;
      padding: 1rem;
      border-left: 5px solid #007bff;
      box-shadow: 0 0 5px #ccc;
    }
    .note h3 {
      margin-top: 0;
    }
    .note-entry {
      margin-bottom: 1rem;
      border-bottom: 1px dashed #ccc;
      padding-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <div class="main">
    <h2>ğŸ“ HSK 4ê¸‰ ì‘ë¬¸ í€´ì¦ˆ</h2>

    <div id="question">
      <strong>Q. ë‹¤ìŒ í•œêµ­ì–´ ë¬¸ì¥ì„ ì¤‘êµ­ì–´ë¡œ ì‘ë¬¸í•˜ì„¸ìš”:</strong>
      <p id="korean"></p>
    </div>

    <label>ë‹¹ì‹ ì˜ ì¤‘êµ­ì–´ ë‹µë³€:</label><br>
    <input type="text" id="userInput" placeholder="ì¤‘êµ­ì–´ ë¬¸ì¥ì„ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¥´ì„¸ìš”" onkeydown="handleKey(event)">

    <br>
    <button onclick="checkAnswer()">âœ… ì œì¶œ</button>
    <button onclick="nextQuestion()">â¡ ë‹¤ìŒ ë¬¸ì œ</button>

    <div id="feedback"></div>
    <div id="comparison" class="result-box"></div>
    <div id="explanation" class="explain"></div>
  </div>

  <div class="note">
    <h3>ğŸ“Œ ì˜¤ë‹µë…¸íŠ¸</h3>
    <div id="wrongList"></div>
  </div>

  <script>
    const questions = [
      {
        ko: "ë‚˜ëŠ” ìš°ì‚°ì„ ê°€ì ¸ì˜¤ëŠ” ê±¸ ìŠì–´ë²„ë ¸ë‹¤.",
        zh: "æˆ‘å¿˜è®°å¸¦ä¼äº†ã€‚",
        explanation: "ğŸ“Œ ë™ì‚¬êµ¬ êµ¬ì¡° 'å¿˜è®° + åŠ¨ä½œ' í™œìš©.\nğŸ‘‰ 'äº†'ëŠ” ê³¼ê±°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤."
      },
      {
        ko: "ë‚˜ëŠ” ê°ê¸°ì— ê±¸ë ¤ì„œ ë³‘ì›ì— ê°€ì•¼ í•´.",
        zh: "æˆ‘æ„Ÿå†’äº†ï¼Œåº”è¯¥å»çœ‹åŒ»ç”Ÿã€‚",
        explanation: "ğŸ“Œ ì›ì¸-ê²°ê³¼ êµ¬ì¡° 'å› ä¸ºï½æ‰€ä»¥ï½' ë˜ëŠ” ì—°ê²°ë§Œìœ¼ë¡œë„ ìì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„ë©ë‹ˆë‹¤."
      },
      {
        ko: "ë§¤ì¼ ì¡°ê¹…í•˜ëŠ” ê²ƒì€ ê±´ê°•ì— ì¢‹ì•„.",
        zh: "æ¯å¤©è·‘æ­¥å¯¹èº«ä½“å¾ˆå¥½ã€‚",
        explanation: "ğŸ“Œ '~ì— ì¢‹ë‹¤'ëŠ” í‘œí˜„ì€ 'å¯¹ ~ å¾ˆå¥½'ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤."
      },
      {
        ko: "ì§€í•˜ì² ì„ íƒ€ëŠ” ê²ƒì€ ì•„ì£¼ í¸ë¦¬í•˜ë‹¤.",
        zh: "ååœ°é“å¾ˆæ–¹ä¾¿ã€‚",
        explanation: "ğŸ“Œ 'ë™ì‚¬ + ëª…ì‚¬ + å¾ˆ + í˜•ìš©ì‚¬' êµ¬ì¡°ë¡œ ìì£¼ ì“°ì…ë‹ˆë‹¤."
      },
      {
        ko: "ë‚ ì”¨ê°€ ì ì  ì¶”ì›Œì§€ê³  ìˆë‹¤.",
        zh: "å¤©æ°”è¶Šæ¥è¶Šå†·äº†ã€‚",
        explanation: "ğŸ“Œ ì ì  ~í•´ì§€ëŠ” êµ¬ì¡°ëŠ” 'è¶Šæ¥è¶Š + í˜•ìš©ì‚¬ + äº†'ì…ë‹ˆë‹¤."
      }
    ];

    let currentIndex = 0;

    function displayQuestion() {
      document.getElementById("korean").textContent = questions[currentIndex].ko;
      document.getElementById("userInput").value = "";
      document.getElementById("feedback").textContent = "";
      document.getElementById("comparison").innerHTML = "";
      document.getElementById("explanation").textContent = "";
    }

    function handleKey(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        checkAnswer();
      }
    }

    function highlightDiffCorrect(correct, user) {
      let result = "";
      const minLen = Math.min(correct.length, user.length);
      for (let i = 0; i < minLen; i++) {
        if (correct[i] === user[i]) {
          result += correct[i];
        } else {
          result += `<span class="wrong">${correct[i]}</span>`;
        }
      }
      if (correct.length > user.length) {
        result += `<span class="wrong">${correct.slice(user.length)}</span>`;
      }
      return result;
    }

    function checkAnswer() {
      const userInput = document.getElementById("userInput").value.trim().replace(/[ï¼Œã€‚ï¼ï¼Ÿ]/g, "");
      const correct = questions[currentIndex].zh.replace(/[ï¼Œã€‚ï¼ï¼Ÿ]/g, "");

      const isCorrect = userInput === correct;
      document.getElementById("feedback").textContent = isCorrect ? "âœ… ì •ë‹µì…ë‹ˆë‹¤!" : "âŒ ì˜¤ë‹µì…ë‹ˆë‹¤.";
      document.getElementById("feedback").style.color = isCorrect ? "green" : "red";

      document.getElementById("comparison").innerHTML = `
        <div class="result-line">ğŸ“¥ <strong>ë‚´ ë‹µ:</strong><br>${userInput || '(ì…ë ¥ ì—†ìŒ)'}</div>
        <div class="result-line">âœ… <strong>ì •ë‹µ:</strong><br>${highlightDiffCorrect(correct, userInput)}</div>
      `;
      document.getElementById("explanation").textContent = questions[currentIndex].explanation;

      // ì˜¤ë‹µì¼ ê²½ìš° ì˜¤ë‹µë…¸íŠ¸ì— ì €ì¥
      if (!isCorrect) {
        const note = document.createElement("div");
        note.className = "note-entry";
        note.innerHTML = `
          <div><strong>Q:</strong> ${questions[currentIndex].ko}</div>
          <div><strong>ë‚´ ë‹µ:</strong> ${userInput || '(ì…ë ¥ ì—†ìŒ)'}</div>
          <div><strong>ì •ë‹µ:</strong> ${questions[currentIndex].zh}</div>
        `;
        document.getElementById("wrongList").appendChild(note);
      }
    }

    function nextQuestion() {
      currentIndex = (currentIndex + 1) % questions.length;
      displayQuestion();
    }

    displayQuestion();
  </script>
</body>
</html>
