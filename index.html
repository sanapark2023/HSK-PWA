<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê°€ì¤‘ì¹˜ ë£°ë › ì¶”ì²¨ê¸°</title>
  <style>
    body {
  font-family: 'Pretendard', sans-serif;
  background: linear-gradient(135deg, #4647C6, #7658CA);
  color: #eee;
  text-align: center;
  margin: 0;
  padding: 30px 0;
}

h2 {
  color: #ffffff;
  font-size: 36px;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.6);
}

h3 {
  color: #e0b3ff;
  margin-bottom: 5px;
  text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.4);
}

.canvas-container {
  width: 480px;
  height: 480px;
  margin: auto;
  border-radius: 50%;
  border: 0px solid rgba(255, 255, 255, 0.08);
  box-shadow:
    0 12px 24px rgba(0, 0, 0, 0.25),       /* ì•„ë˜ìª½ ê¹Šì´ê° */
    0 4px 8px rgba(255, 255, 255, 0.05),   /* ìœ„ìª½ ë¹›ë°˜ì‚¬ */
    0 0 20px rgba(79, 19, 169, 0.3),       /* í¼í”Œ ê¸€ë¡œìš° */
    inset 0 0 10px rgba(255, 255, 255, 0.04);  /* ë‚´ë¶€ ì€ì€í•¨ */
  transition: transform 3s ease-out;
}

canvas {
  border-radius: 50%;
  border: 4px solid rgba(255, 255, 255, 0.264);
  position: absolute;
  top: 0;
  left: 0;
  transition: transform 3s ease-out;
}


button {
  margin-top: 30px;
  background: linear-gradient(to right, #0C085F, #0C085F);
  border: none;
  padding: 12px 24px;
  border-radius: 12px;
  font-size: 14px;
  font-weight: bold;
  color: #fff;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
  transition: transform 0.2s ease;
}

button:hover {
  transform: scale(1.05);
}

.arrow {
  position: absolute;
  top: 50%;
  left: 15px;
  transform: translate(-100%, -50%) rotate(90deg);
  width: 0;
  height: 0;
  border-left: 20px solid transparent;
  border-right: 20px solid transparent;
  border-bottom: 30px solid #ff0080;
  filter: drop-shadow(0 0 6px #ff8ce2)
          drop-shadow(0 0 12px #fff)
          drop-shadow(0 0 16px #ff8ce2);
  z-index: 10;
}

.container {
  position: relative;
  width: 500px;
  height: 500px;
  margin: 0 auto;
}

.results {
  text-align: left;
  color: #fff;
  border-radius: 24px;
  height: 100%;
}
.results h3{
  margin: 0;
}

ul {
  padding-left: 0;
  list-style: none;
}

.winner-popup {
  font-size: 36px;
  font-weight: bold;
  color: white;
  background: rgba(50, 0, 90, 0.8);
  padding: 16px 30px;
  border-radius: 20px;
  text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: 0 0 30px #fff, 0 0 50px #f72585;
  animation: pop 1s ease-out, confetti 2s ease-in-out;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 999;
}

@keyframes pop {
  0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
  60% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
}

@keyframes confetti {
  0% { box-shadow: 0 0 20px #f1c40f; }
  50% { box-shadow: 0 0 60px #f1c40f; }
  100% { box-shadow: 0 0 20px #f1c40f; }
}

.layout {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  gap: 80px;
  margin-top: 30px;
  height: 100%;
}

pre#adminWinnerLog {
  user-select: text;
  color: #fff;
  background: #4b0082;
  font-size: 15px;
  overflow-x: auto;
  white-space: pre-wrap;
  padding: 16px;
  border: 2px dashed #f1c40f;
  border-radius: 12px;
}

div[style*="margin-top: 100px"] {
  background: linear-gradient(90deg, #6a0572, #ab83a1);
  border-top: 3px solid #f1c40f;
  color: #fff;
}

  </style>
</head>
<body style="padding: 64px;">
  <p style="font-size: 24px; margin: 0; margin-bottom: 8px;">YEATU</p>
  <h2 style="color: #F6EB77; font-size: 36px; margin-top: 0;">ê°€ì…í•˜ë©´ 100ë§Œì› í–‰ìš´ ë£°ë ›</h2>
  <div class="layout">
    <div class="results">
      <h3>ğŸ‘‘ 2ë“± (10ëª…)</h3>
      <ul id="second"></ul>
      <h3>ğŸ‰ 3ë“± (20ëª…)</h3>
      <ul id="third"></ul>
    </div>
    <div class="containter2">
      <div class="container">
        <div class="arrow"></div>
        <div class="canvas-container">
          <canvas id="wheel" width="500" height="500"></canvas>
        </div>
        <div id="popup" class="winner-popup" style="display:none;"></div>
      </div>
      <button onclick="startDraw()">ì¶”ì²¨ ì‹œì‘</button>
    </div>
  </div>

  <div style="margin-top: 100px; padding: 20px; background: #fffbe500; border-top: 2px solid #bfa12c;">
    <h4 style="font-weight: normal; color: #bfa12c;">â€» ì•„ë˜ ëª…ë‹¨ì€ ê´€ë¦¬ììš©ì…ë‹ˆë‹¤. (ë“œë˜ê·¸í•´ì„œ ë³µì‚¬ ê°€ëŠ¥)</h4>
    <pre id="adminWinnerLog" style="user-select: text; color: #ab83a1; background: #fffbe500; font-size: 14px; overflow-x: auto; white-space: pre-wrap; padding: 10px; border: 1px dashed #bfa12c;"></pre>
  </div>
<script>
const participants = [
  { name: "ë¥˜*ì˜", tickets: 5, email: "juyoung.ryu@evertreasure.xyz" },
  { name: "ì„*ì§„", tickets: 1, email: "peter.im@evertreasure.xyz" },
  { name: "êµ¬*ì •", tickets: 27, email: "hyunjung.koo@evertreasure.xyz" },
  { name: "ë°•*í•˜", tickets: 3, email: "uni08ray@gmail.com" },
  { name: "ë‚¨*í˜„", tickets: 1, email: "jinhyunnam@gmail.com" },
  { name: "ê°•*ê·œ", tickets: 1, email: "bokyukang81@gmail.com" },
  { name: "S******", tickets: 2, email: "sean.gn7@gmail.com" },
  { name: "ë°•*ìˆ˜", tickets: 1, email: "jisubag199@gmail.com" },
  //{ name: "ì¡°*ë¦°", tickets: 11, email: "everine.jo@evertreasure.xyz" },
  { name: "ì„œ*ì—°", tickets: 1, email: "tnsjrnfl@naver.com" },
  { name: "ë³€*ì„", tickets: 8, email: "autumn.byun@evertreasure.xyz" },
  { name: "í•¨*ë¯¸", tickets: 2, email: "youjin33333@gmail.com" },
  { name: "ë³€*ì„ ", tickets: 2, email: "bgs5908@gmail.com" },
  { name: "J******", tickets: 8, email: "stylish.jk@gmail.com" },
  { name: "ì¡°*í˜„", tickets: 2, email: "hyuntae60@gmail.com" },
  { name: "ê³µ*í˜„", tickets: 2, email: "rhdtmddnr1@naver.com" },
  { name: "l******", tickets: 2, email: "lunarisdh@gmail.com" },
  { name: "ê¹€*ì›", tickets: 2, email: "ksw6962@naver.com" },
  { name: "1*******", tickets: 2, email: "11yjh11@naver.com" },
  { name: "t****", tickets: 1, email: "trumc@naver.com" },
  { name: "ì¡°*ì„ ", tickets: 2, email: "minseonjo453@gmail.com" },
  { name: "ë°•*ë¯¼", tickets: 1, email: "begum75737540@gmail.com" },
  { name: "í•˜*", tickets: 2, email: "weds01125@gmail.com" },
  { name: "ê¹€*ìš°", tickets: 1, email: "lovebabyny@naver.com" },
  { name: "ì—¼*í›ˆ", tickets: 1, email: "yeomjh0@gmail.com" },
  { name: "e****", tickets: 1, email: "eris9@daum.net" },
  { name: "ì´*ì˜", tickets: 1, email: "junyoung2691@naver.com" },
  { name: "ê¹€*ìš°", tickets: 1, email: "wooki.creator@gmail.com" },
  { name: "ê¹€*ì‹ ", tickets: 1, email: "entia2004@naver.com" },
  { name: "ê¹€*í˜„", tickets: 2, email: "seohyeon.kim@evertreasure.xyz" },
  { name: "ì˜*", tickets: 2, email: "shinpark98@daum.net" },
  { name: "b********", tickets: 2, email: "blueraindrops@hanmail.net" },
  { name: "ìµœ*ì‹", tickets: 3, email: "centmania1013@gmail.com" },
  { name: "ì´*ì˜", tickets: 2, email: "leebona1015@gmail.com" },
  { name: "í—ˆ*í˜„", tickets: 2, email: "hankheo@naver.com" },
  { name: "G*******", tickets: 2, email: "diefull000@gmail.com" },
  { name: "H***********", tickets: 1, email: "hyunjung.koo@evertreasure.xyz" },
  { name: "R********", tickets: 2, email: "roms@kakao.com" },
  { name: "S*", tickets: 2, email: "sybaek31@gmail.com" },
  { name: "ê¹€*ê²¸", tickets: 1, email: "ron0719@naver.com" },
  { name: "ê¹€*êµ¬", tickets: 2, email: "t01049350822@gmail.com" },
  { name: "ê°•*ë¦¬", tickets: 2, email: "gnr9706@gmail.com" },
  { name: "êµ¬*ê¸°", tickets: 2, email: "kth.ksk1209@gmail.com" },
  { name: "ì˜¤*ë¼", tickets: 5, email: "dkfkgid@naver.com" },
  { name: "ë¥˜*ìš±", tickets: 1, email: "rjwhaha@hanmail.net" },
  { name: "ë¥˜*ì´", tickets: 2, email: "rjeho@naver.com" },
  { name: "ë°•*ì—°", tickets: 1, email: "dyb2012@gmail.com" },
  { name: "ìœ *ìŠ¤", tickets: 2, email: "eunice356@naver.com" },
  { name: "ì¥*ì—°", tickets: 1, email: "jang.sy720@gmail.com" },
  { name: "m*", tickets: 2, email: "with_mj@hotmail.com" },
  { name: "íƒœ*", tickets: 2, email: "daliza.hwan@gmail.com" },
  { name: "e****", tickets: 1, email: "eris9@daum.net" },
  { name: "c*********", tickets: 1, email: "ceo@hanmia.com" },
  { name: "ê¹€*ì‹", tickets: 1, email: "ysk1048@naver.com" },
  { name: "ê¹€*íƒœ", tickets: 2, email: "okgoldshine1@gmail.com" },
  { name: "h********g", tickets: 2, email: "horin1224@gmail.com" },
];

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const popup = document.getElementById("popup");
let ticketPool = [];
let currentWinners = new Set();
let rotation = 0;

function buildTicketPool() {
  ticketPool = [];
  participants.forEach(p => {
    if (!currentWinners.has(p.name)) {
      for (let i = 0; i < p.tickets; i++) {
        ticketPool.push(p.name);
      }
    }
  });
}

function drawWheel() {
  ctx.clearRect(0, 0, 500, 500);
  let total = ticketPool.length;
  let counts = {};
  ticketPool.forEach(name => counts[name] = (counts[name] || 0) + 1);
  let uniqueNames = Object.keys(counts);
  let startAngle = 0;
  uniqueNames.forEach((name, i) => {
    const slice = (counts[name] / total) * Math.PI * 2;
    ctx.beginPath();
    ctx.moveTo(250, 250);
    ctx.arc(250, 250, 250, startAngle, startAngle + slice);
    ctx.fillStyle = `hsl(${i * 25}, 70%, 60%)`;
    ctx.fill();
    ctx.save();
    ctx.translate(250, 250);
    ctx.rotate(startAngle + slice / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#000";
    ctx.font = "14px sans-serif";
    ctx.fillText(name, 230, 0);
    ctx.restore();
    startAngle += slice;
  });
}

function spinOnce(prizeLevel, ulId) {
  return new Promise(resolve => {
    buildTicketPool();
    drawWheel();

    const randIndex = Math.floor(Math.random() * ticketPool.length);
    const chosenName = ticketPool[randIndex];
    let total = ticketPool.length;
    let counts = {};
    ticketPool.forEach(name => counts[name] = (counts[name] || 0) + 1);
    let uniqueNames = Object.keys(counts);

    let startAngle = 0;
    let chosenAngle = 0;
    for (let name of uniqueNames) {
      const slice = (counts[name] / total) * 360;
      if (name === chosenName) {
        chosenAngle = startAngle + slice / 2;
        break;
      }
      startAngle += slice;
    }

    const targetAngle = 180;
    const currentRotation = rotation % 360;
    const delta = (360 + targetAngle - chosenAngle - currentRotation) % 360;
    const spinAngle = 360 * 5 + delta;
    rotation += spinAngle;
    canvas.style.transform = `rotate(${rotation}deg)`;

    setTimeout(() => {
      currentWinners.add(chosenName);
      const ul = document.getElementById(ulId);
      const li = document.createElement("li");
      li.textContent = chosenName;
      ul.appendChild(li);

      popup.textContent = `ğŸ‰ ${chosenName}ë‹˜ ë‹¹ì²¨!`;
      popup.style.display = 'block';
      setTimeout(() => popup.style.display = 'none', 2000);

      const winnerInfo = participants.find(p => p.name === chosenName);
      if (winnerInfo) {
        const entry = `${prizeLevel} - ${winnerInfo.name} (${winnerInfo.email})\n`;
        document.getElementById("adminWinnerLog").textContent += entry;
      }

      resolve();
    }, 4500);
  });
}

async function startDraw() {
  currentWinners = new Set();
  document.getElementById("second").innerHTML = "";
  document.getElementById("third").innerHTML = "";
  document.getElementById("adminWinnerLog").textContent = "";
  rotation = 0;

  buildTicketPool();
  drawWheel();

  for (let i = 0; i < 10; i++) {
    await spinOnce("2ë“±", "second");
  }
  for (let i = 0; i < 20; i++) {
    await spinOnce("3ë“±", "third");
  }
}

buildTicketPool();
drawWheel();
</script>
</body>
</html>